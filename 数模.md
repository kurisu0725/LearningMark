## 数学建模

### 模拟退火

用于解决目标函数的最值问题（旅行商问题、买书花费、利润等）。

**步骤：**

1. 初始化生成一个解 $x_i $, 对应函数值为$f(x_i)$

2. 在 $x_i$ 附近随机寻找一个新的解$x_j$, 对应的函数值为$f(x_j)$

3.  若 $f(x_j) > f(x_i)$, 则接受新解 $x_j$.

   若 $ f(x_j) <= f(x_i), $ 则 一定概率 $p$ 接受新解，$p \in [0,1]$ . 

   $p_t = e^{-|f(x_i) - f(x_j)| \times C_t}$ , 然后随机生成一个介于$[0, 1]$ 之间的随机数$r$ ,

   如果 $r < p$,  就接受新解；否则，回到步骤2.

   也就是说 $p$ 越大，生成小于$p$的数的概率越大 <-> 接受新解的概率越大，这里引入$r$ 是体现了这一思想的。

   **原理**：

    $f(x_j)，f(x_i)$  越接近，$p$越大。（新解和旧解的函数值越接近，我们就越愿意接受)。即$p$ 正比于 $\frac {1} {|f(x_i) - f(x_j)|}$。

   

   考虑$p \in [0, 1]$ ，函数 $y = e^{-x} (x \geq 0)$的值域在$[0, 1]$ 之间。所以可以假设

   $p \propto e ^{-|f(x_i) - f(x_j)|}$ , 即 $p$ 正比于 $e ^{-|f(x_i) - f(x_j)|}$。

   在搜索前期，尽可能的扩大搜索范围，后期倾向于局部搜索。这样能够避免陷入局部最优解。$p$ 还需与时间有关。对式子$p \propto e ^{-|f(x_i) - f(x_j)|}$进行变形:
   $$
   p_t \propto e^{-|f(x_i) - f(x_j)| \times C_t}
   $$
   $C_t$ 为一个和时间有关的系数，时间越长，$C_t$ 递增。模拟淬火中定义初始温度$T_0$ , 温度下降的公式为: $T_t+1 = \alpha T_t, 一般 \alpha = 0.95$ ，那么$t$ 时刻的温度: $T_t = \alpha ^ {t} T_0 = 0.95^{t} \cdot T_0$ ，取
   $$
   C_t = \frac{1}{\alpha^{t} \cdot T_0} \\
   因为 \alpha^{t} 为递减函数，取倒数则 C_t 与 t 正比。
   $$
   
4. 停止搜索：达到迭代次数；达到指定的函数值；找到的最优解连续M次迭代都没有变化

**补充：**

- 优化问题有约束条件如何解决？

  生成新解B的时候，判断满不满足约束条件即可。

  增加惩罚函数。

- $C_t$ 的设置？

- 搜索过程结束？

- 如何在旧解A的附近生成新解B？

产生新解的规则：
![image-20230905102306442](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20230905102306442.png)

